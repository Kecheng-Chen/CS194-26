<!doctype html>
<html>
<head>
  <style>body{font-family:verdana;padding-left:15%;padding-right:15%;}h3{text-align:center;}</style>
</head>
<body>
<h3>CS 194-26 Project 5: Auto Stitching Photo Mosaics</h3>
<h5 style="text-align:center">2020 Nov 26, cs194-26 (Kecheng Chen)</h5>
<h4>Part A</h4>
<h4>Shoot the Pictures</h4>
<p>Target at Berkeley downtown</p>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/3.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Recover Homographies</h4>
<p>To calculate homography matrix, the below formulation is followed. The rightest column of V which corresponds to the smallest signular value is the solution.</p>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/f3.png" width="360px" />
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/f1.png" width="70px" />
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/f2.png" width="200px" />
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/s1.png" width="340px" />
            <figcaption align="middle">Control points selection</figcaption>
            <br>
            <td align="middle">
            <img src="a/s2.png" width="400px" />
            <figcaption align="middle">Normalized cross-correlation matching</figcaption>
            <br>
        </tr>
    </table>
</div>

<h4>Warp the Images</h4>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/s3.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/s4.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Image Rectification</h4>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/church1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/s5.png" width="320px" />
            <br>
            <td align="middle">
            <img src="a/s6.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="a/church2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/s7.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/s8.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Blend the images into a mosaic</h4>
<p>Laplacian pyramid is used to do the image blending.</p>

<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="a/s9.jpg" width="320px" />
            <figcaption align="middle">Naive addition</figcaption>
            <br>
            <td align="middle">
            <img src="a/s10.jpg" width="320px" />
            <figcaption align="middle">Naive blending</figcaption>
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="a/s11.jpg" width="320px" />
            <figcaption align="middle">Two-level pyramid</figcaption>
            <br>
            <td align="middle">
            <img src="a/s12.jpg" width="320px" />
            <figcaption align="middle">Five-level pyramid</figcaption>
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="a/b1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/b2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/b3.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>

<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="a/c1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/c2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="a/c3.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Tell us what you've learned</h4>
<p>I learned that even without depth information, 2D scenary construction can also be done.</p>
<br>
<p>Reference:</p>
<p>https://cseweb.ucsd.edu/classes/wi07/cse252a/homography_estimation/homography_estimation.pdf</p>

<br>
<h4>Part B</h4>
<h4>Detecting corner features in an image</h4>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/imageproxy.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s1.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s2.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s4.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s6.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s5.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s7.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/3.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s13.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s15.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/4.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s14.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s16.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/e1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/e3.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/e5.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/e2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/e4.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/e6.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Adaptive Non-Maximal Suppression</h4>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/s3.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s8.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s9.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/s17.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s18.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/e7.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/e8.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Feature Descriptor extraction</h4>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/s10.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>Feature Matching</h4>
<p>SSD(first nearest neighbourhood)/SSD(second nearest neighbourhood)<0.3</p>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/s11.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s12.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/s19.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/s20.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/e9.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/e10.png" width="320px" />
            <br>
        </tr>
    </table>
</div>


<h4>Directly stitch without RANSAC (not good)</h4>
<div align="center">
	<table style="width=100%">
		<tr>
			<td align="middle">
            <img src="b/ss1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ss2.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ss3.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/ss6.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ss7.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/ee1.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ee2.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>RANSAC</h4>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/ss4.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ss5.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/ss8.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ss9.jpg" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/ee3.jpg" width="320px" />
            <br>
            <td align="middle">
            <img src="b/ee4.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

<h4>What have you learned?</h4>
<p>Automatic image stitching may perform better effect compared with the approach using manually selected feature points. It saves a lot of time. However, there are also some failure cases. When I applied this automatic method on the images with large angle interval, less than 4 pairs of feature points would be selected after feature matching. It is not enough for calculating H matrix. To deal with this situation, more advanced technology like deep learning can be tried. Also, there are some cases that feature points are wrongly matched.</p>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/c3.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/c4.png" width="320px" />
            <br>
        </tr>
    </table>
</div>
<div align="center">
	<table style="width=100%">
		<tr>
            <td align="middle">
            <img src="b/dd1.png" width="320px" />
            <br>
            <td align="middle">
            <img src="b/dd2.png" width="320px" />
            <br>
        </tr>
    </table>
</div>

